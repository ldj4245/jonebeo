<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
  <head th:replace="~{fragments/layout :: head(${pageTitle})}"></head>
  <body>
    <header th:replace="~{fragments/layout :: header}"></header>
    <main class="container">
      <section class="board-header">
        <h1 th:text="${board.name}"></h1>
        <p
          th:text="${board.description != null ? board.description : '소개 문구가 준비 중입니다.'}"
        ></p>
        <div class="board-meta">
          <span th:text="${'슬러그: ' + board.slug}"></span>
          <span
            th:if="${board.createdAt != null}"
            th:text="${' · 생성일: ' + #temporals.format(board.createdAt, 'yyyy-MM-dd')}"
          ></span>
        </div>
        <div class="board-actions board-actions--center">
          <a
            class="button"
            th:if="${isAuthenticated}"
            th:href="@{/posts/new(boardId=${board.id})}"
            >글쓰기</a
          >
          <a
            class="button button-secondary"
            th:if="${!isAuthenticated}"
            th:href="@{/auth/login(redirect=${'/posts/new?boardId=' + board.id})}"
            >글쓰기</a
          >
        </div>
        <p
          class="board-login-hint"
          th:if="${!isAuthenticated}"
        >
          글쓰기를 하려면 먼저 로그인해주세요.
        </p>
      </section>

      <section th:if="${!#lists.isEmpty(posts.content)}">
        <div class="post-list">
          <article class="post-card" th:each="post : ${posts.content}">
            <div>
              <a
                class="post-title"
                th:href="@{'/posts/' + ${post.id}}"
                th:text="${post.title}"
              ></a>
              <div class="post-meta">
                <span th:text="${post.author.nickname}"></span>
                <span> · </span>
                <span
                  th:text="${#temporals.format(post.createdAt, 'yyyy-MM-dd HH:mm')}"
                ></span>
              </div>
            </div>
            <div class="post-stats">
              <span th:text="${'조회 ' + post.viewCount}"></span>
            </div>
          </article>
        </div>

        <div class="pagination">
          <a
            th:if="${posts.page > 0}"
            th:href="@{'/boards/' + ${board.slug} + '?page=' + (${posts.page} - 1)}"
            >이전</a
          >
          <span
            th:text="${posts.totalPages > 0 ? (posts.page + 1) + ' / ' + posts.totalPages : '1 / 1'}"
          ></span>
          <a
            th:if="${posts.hasNext}"
            th:href="@{'/boards/' + ${board.slug} + '?page=' + (${posts.page} + 1)}"
            >다음</a
          >
        </div>
      </section>

      <section class="empty-state" th:if="${#lists.isEmpty(posts.content)}">
        <p>아직 작성된 게시글이 없습니다. 첫 번째 글을 작성해보세요!</p>
        <div class="board-actions">
          <a
            class="button"
            th:if="${isAuthenticated}"
            th:href="@{/posts/new(boardId=${board.id})}"
            >글쓰기</a
          >
          <a
            class="button button-secondary"
            th:if="${!isAuthenticated}"
            th:href="@{/auth/login(redirect=${'/posts/new?boardId=' + board.id})}"
            >글쓰기</a
          >
        </div>
        <p
          class="board-login-hint"
          th:if="${!isAuthenticated}"
        >
          로그인하면 첫 번째 글의 주인공이 될 수 있어요!
        </p>
      </section>
    </main>
    <footer th:replace="~{fragments/layout :: footer}"></footer>
  </body>
</html>
